!function(){const e="michael",n="boy",t="speechSynthesis"in window&&"SpeechSynthesisUtterance"in window;function o(e){if(!t)return null;const n=new window.SpeechSynthesisUtterance(e);return n.pitch=.8,n.rate=1.25,n}function i(e){return new Promise(((n,t)=>{if(!e)return t();let o=!1;e.onstart=function(){o=!0},e.onend=function(){n()},e.onerror=function(){t()},window.speechSynthesis.speak(e),setTimeout((function(){o||t()}),3e3)}))}function a(e,n){const t=new URLSearchParams(window.location.search);t.set(e,n),history.replaceState(null,null,"?"+t.toString())}function c(e){window.document.title=e+", it's your birthday today"}function r(e,n){var t=null;return function(){var o=this,i=arguments;clearTimeout(t),t=setTimeout((function(){e.apply(o,i)}),n)}}function s(e,n){return window.BLOCKED_TEXT.some((n=>e.toLowerCase().includes(n)))?n:e}const d=decodeURIComponent(window.location.hash.slice(1)),u=new URLSearchParams(window.location.search),y=u.has("name")?decodeURIComponent(u.get("name")):null,l=u.has("identity")?decodeURIComponent(u.get("identity")):null,m=document.querySelector("#input-name"),h=document.querySelector("#input-identity"),p=document.querySelector(".video"),f=document.querySelector("#play"),w=document.querySelector("#mute"),S=document.querySelector("#reduce-motion"),v=document.querySelector("details");v.addEventListener("click",(e=>{e.target===v&&v.removeAttribute("open")}));const L=s(y||d||e,e),C=s(l||n,n),g={name:L,nameSpeechSynthesis:o(L),identity:C,identitySpeechSynthesis:o(C),firstTry:!0};function k(){m.value!==g.name&&(g.name=s(m.value,e),""===g.name&&(g.name=e),g.nameSpeechSynthesis=o(g.name),a("name",encodeURIComponent(g.name)),c(g.name))}function E(){h.value!==g.identity&&(g.identity=s(h.value,n),""===g.identity&&(g.identity=n),g.identitySpeechSynthesis=o(g.identity),a("identity",encodeURIComponent(g.identity)))}m.value=g.name,h.value=g.identity,g.name&&g.name!==e&&c(g.name),k(),E(),m.addEventListener("change",k),m.addEventListener("keyup",r(k,200)),h.addEventListener("change",E),h.addEventListener("keyup",r(E,200));const b={intro:[0,7600],name:[7600,550],cakeAndIcecream:[8150,3600],suchAGoodBoy:[12200,550],boy:[12750,250],thisYearWowWeGonnaCheer:[13e3,2650]},T=new window.Howl({src:["rats.mp3"],sprite:b}),U={},I=w.textContent;function q(e){document.body.classList.toggle("prefers-reduced-motion",e),e?(S.dataset.pressed="true",p.src="rats-no-motion.gif"):(S.dataset.pressed="false",p.src="rats.gif")}w.addEventListener("click",(function(){const e=w.textContent===I;T.mute(e),w.textContent=e?"un"+I:I}));const A=window.matchMedia("(prefers-reduced-motion: reduce)");function R(){g.firstTry?T.play(U.cakeAndIcecream):T.play(U.suchAGoodBoy),g.firstTry=!g.firstTry}function G(){T.play(U.thisYearWowWeGonnaCheer)}function W(){if(g.name===e)return T.play(U.name);i(g.nameSpeechSynthesis).catch((()=>{T.play(U.name)})).finally((()=>{R()}))}function B(){if(g.identity===n)return T.play(U.boy);i(g.identitySpeechSynthesis).catch((()=>{T.play(U.boy)})).finally((()=>{G()}))}q(A.matches),A.addEventListener("change",(({matches:e})=>{q(e)})),S.addEventListener("click",(function(){q("false"===S.dataset.pressed)})),f.addEventListener("click",(function(){p.classList.remove("video-hidden"),T.mute(!0),Object.keys(b).forEach((e=>{U[e]=T.play(e),T.pause(U[e])})),T.mute(!1),T.play(U.intro),f.innerHTML="Loading...",f.disabled=!0,T.on("play",(function(){f.style.display="none"}),U.intro),T.on("end",W,U.intro),T.on("end",R,U.name),T.on("end",W,U.cakeAndIcecream),T.on("end",B,U.suchAGoodBoy),T.on("end",G,U.boy),T.on("end",(function(){T.seek(.3,U.intro),T.play(U.intro)}),U.thisYearWowWeGonnaCheer)}))}();