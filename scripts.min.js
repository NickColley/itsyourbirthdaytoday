!function(){const e="michael",n="boy",t="speechSynthesis"in window&&"SpeechSynthesisUtterance"in window;function i(e){if(!t)return null;const n=new window.SpeechSynthesisUtterance(e);return n.pitch=.8,n.rate=1.25,n}function o(e){return new Promise(((n,t)=>{if(!e)return t();let i=!1;e.onstart=function(){i=!0},e.onend=function(){n()},e.onerror=function(){t()},window.speechSynthesis.speak(e),setTimeout((function(){i||t()}),3e3)}))}function a(e,n){const t=new URLSearchParams(window.location.search);t.set(e,n),history.replaceState(null,null,"?"+t.toString())}function c(e){window.document.title=e+", it's your birthday today"}function d(e,n){var t=null;return function(){var i=this,o=arguments;clearTimeout(t),t=setTimeout((function(){e.apply(i,o)}),n)}}function s(e,n){return window.BLOCKED_TEXT.some((n=>e.toLowerCase().includes(n)))?n:e}const r=decodeURIComponent(window.location.hash.slice(1)),u=new URLSearchParams(window.location.search),l=u.has("name")?decodeURIComponent(u.get("name")):null,y=u.has("identity")?decodeURIComponent(u.get("identity")):null,m=document.querySelector("#input-name"),h=document.querySelector("#input-identity"),p=document.querySelector(".video"),f=document.querySelector("#play"),w=document.querySelector("#mute"),S=document.querySelector("#reduce-motion"),v=document.querySelector("details");v.addEventListener("click",(e=>{e.target===v&&v.removeAttribute("open")}));const L=s(l||r||e,e),g=s(y||n,n),E={isMuted:null,name:L,nameSpeechSynthesis:i(L),identity:g,identitySpeechSynthesis:i(g),firstTry:!0};function k(){m.value!==E.name&&(E.name=s(m.value,e),""===E.name&&(E.name=e),E.nameSpeechSynthesis=i(E.name),a("name",encodeURIComponent(E.name)),c(E.name))}function C(){h.value!==E.identity&&(E.identity=s(h.value,n),""===E.identity&&(E.identity=n),E.identitySpeechSynthesis=i(E.identity),a("identity",encodeURIComponent(E.identity)))}m.value=E.name,h.value=E.identity,E.name&&E.name!==e&&c(E.name),k(),C(),m.addEventListener("change",k),m.addEventListener("keyup",d(k,200)),h.addEventListener("change",C),h.addEventListener("keyup",d(C,200));const b={intro:[0,7600],name:[7600,550],cakeAndIcecream:[8150,3600],suchAGoodBoy:[12200,550],boy:[12750,250],thisYearWowWeGonnaCheer:[13e3,2650]},M=new window.Howl({src:["rats.mp3"],sprite:b}),T={},U=w.textContent;function I(e){document.body.classList.toggle("prefers-reduced-motion",e),e?(S.dataset.pressed="true",p.src="rats-no-motion.gif"):(S.dataset.pressed="false",p.src="rats.gif")}w.addEventListener("click",(function(){E.isMuted=!E.isMuted,M.mute(E.isMuted),w.textContent=E.isMuted?"un"+U:U})),document.addEventListener("visibilitychange",(()=>{console.log(E.isMuted),null===E.isMuted&&M.mute(document.hidden)}));const q=window.matchMedia("(prefers-reduced-motion: reduce)");function A(){E.firstTry?M.play(T.cakeAndIcecream):M.play(T.suchAGoodBoy),E.firstTry=!E.firstTry}function R(){M.play(T.thisYearWowWeGonnaCheer)}function G(){if(E.isMuted||E.name===e)return M.play(T.name);o(E.nameSpeechSynthesis).catch((()=>{M.play(T.name)})).finally((()=>{A()}))}function W(){if(E.isMuted||E.identity===n)return M.play(T.boy);o(E.identitySpeechSynthesis).catch((()=>{M.play(T.boy)})).finally((()=>{R()}))}q.addEventListener("change",(({matches:e})=>{I(e)})),S.addEventListener("click",(function(){I("false"===S.dataset.pressed)})),f.addEventListener("click",(function(){I(q.matches),M.mute(!0),Object.keys(b).forEach((e=>{T[e]=M.play(e),M.pause(T[e])})),M.mute(!1),M.play(T.intro),f.innerHTML="Loading...",f.disabled=!0,M.on("play",(function(){f.style.display="none"}),T.intro),M.on("end",G,T.intro),M.on("end",A,T.name),M.on("end",G,T.cakeAndIcecream),M.on("end",W,T.suchAGoodBoy),M.on("end",R,T.boy),M.on("end",(function(){M.seek(.3,T.intro),M.play(T.intro)}),T.thisYearWowWeGonnaCheer)}))}();